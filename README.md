# open_backend_example

Пример простого backend-приложения на [FastAPI](https://fastapi.tiangolo.com/),
которое реализует модель и структуру базы данных согласно изображению с таблицей
`Users`. Приложение предоставляет CRUD-интерфейс для управления сотрудниками.

## Структура данных

В таблице `users` хранятся следующие поля:

| Поле                | Тип                    | Описание                         |
|---------------------|------------------------|----------------------------------|
| `id`                | UUID (строка)          | Уникальный идентификатор записи |
| `created_at`        | datetime (timezone)    | Дата создания записи             |
| `name`              | varchar(100)           | Имя сотрудника                   |
| `surname`           | varchar(100)           | Фамилия сотрудника               |
| `email`             | varchar(255)           | Email сотрудника                 |
| `phone`             | varchar(20)            | Номер телефона                   |
| `city`              | varchar(100)           | Город проживания                 |
| `working_format`    | enum(remote/office/…)  | Формат работы                    |

Enum `working_format_enum` содержит значения `remote`, `office`, `hybrid`.

## Запуск через Docker

1. Запустите приложение с помощью Docker Compose:

   ```bash
   docker-compose up -d
   ```

2. Приложение будет доступно по адресу `http://localhost:8001`

3. Для остановки:

   ```bash
   docker-compose down
   ```

База данных SQLite создается внутри контейнера. Данные будут потеряны при удалении контейнера.

### Заполнение тестовыми данными

Для заполнения базы данных 40 фейковыми записями пользователей:

```bash
docker cp seed_db.py open_backend_example-app-1:/app/
docker compose exec app python seed_db.py
```

## Локальный запуск без Docker

1. Создайте и активируйте виртуальное окружение Python 3.10+.
2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

3. Запустите приложение:

   ```bash
   uvicorn app.main:app --reload
   ```

По умолчанию используется SQLite-файл `app.db` в корне проекта. Для работы с
PostgreSQL установите переменную окружения `DATABASE_URL`, например:

```bash
export DATABASE_URL=postgresql+psycopg://user:password@localhost:5432/mydb
```

При старте приложения автоматически создаются таблицы, соответствующие модели.

## Примеры запросов

После запуска FastAPI документация доступна по адресу `http://127.0.0.1:8000/docs` (или `http://127.0.0.1:8001/docs` при запуске через Docker).
Можно использовать следующие запросы:

- `POST /users` — создание пользователя;
- `GET /users` — список пользователей;
- `GET /users/{id}` — получение пользователя по идентификатору;
- `PATCH /users/{id}` — обновление данных;
- `DELETE /users/{id}` — удаление.

Каждый ответ соответствует Pydantic-схеме `UserRead` и содержит актуальную
информацию по модели.
